"use strict";
angular.module("maziiLearn.localStorage", []).factory("localstoreServ", ["$http", function (a) {
        var b = {};
        return b.setItem = function (a, b) {
            localStorage.setItem(a, angular.toJson(b))
        }, b.getItem = function (a) {
            var b = localStorage.getItem(a);
            return angular.fromJson(b)
        }, b.deleteItem = function (a) {
            localStorage.removeItem(a)
        }, b.clear = function () {
            localStorage.clear()
        }, b
    }]), 
angular.module("maziiLearn.service.data", []).factory("dataServ", ["$http", function (a) {
        function b(a, b) {
            return null == v ? void b(null) : void v.transaction(function (c) {
                c.executeSql(a, [], function (a, c) {
                    var d = null;
                    if (c.rows.length > 0) {
                        d = [];
                        for (var e = 0; e < c.rows.length; e++) {
                            var f = c.rows.item(e);
                            d.push(f)
                        }
                    }
                    null != b && b(d)
                })
            }, function (a) {
                console.log("ERROR: " + JSON.stringify(a)), null != b && b(null)
            })
        }
        function c(a, c) {
            b(a, function (a) {
                c(a)
            })
        }
        var d = {}, e = null, f = null, g = null, h = null, i = null, j = null, k = null, l = null, m = null, n = null, o = null, p = null, q = null, r = null, s = null, t = null, u = !1, v = null, w = function () {
            a.get("chucai/json_chucai").then(function (a) {
                e = a.data
            }, function (a) {
            }), a.get("db/phrase.json").then(function (a) {
                f = a.data
            }, function (a) {
            }), a.get("db/kotoba.json").then(function (a) {
                g = a.data
            }, function (a) {
            }), a.get("db/ikanji.json").then(function (a) {
                h = a.data
            }, function (a) {
            }), a.get("db/kanji.json").then(function (a) {
                i = a.data
            }, function (a) {
            }), a.get("db/grammar.json").then(function (a) {
                j = a.data
            }, function (a) {
            }), a.get("db/kaiwa.json").then(function (a) {
                k = a.data
            }, function (a) {
            }), a.get("db/mondai.json").then(function (a) {
                l = a.data
            }, function (a) {
            }), a.get("db/bunkei.json").then(function (a) {
                m = a.data
            }, function (a) {
            }), a.get("db/reibun.json").then(function (a) {
                n = a.data
            }, function (a) {
            }), a.get("db/reference.json").then(function (a) {
                o = a.data    
            }, function (a) {
            }), a.get("db/jlpt.json").then(function (a) {
                p = a.data
            }, function (a) {
            }), a.get("db/listen.json").then(function (a) {
                q = a.data
            }, function (a) {
            }), a.get("db/duoshi.json").then(function (a) {
                r = a.data
            }, function (a) {
            }), a.get("db/jitadoushi.json").then(function (a) {
                s = a.data
            }, function (a) {
            }), a.get("db/kanjiset.json").then(function (a) {
                t = a.data
            }, function (a) {
            })
        };
        return d.checkDatabase = function (a) {
            var b = !1;
            "undefined" != typeof plugins && plugins.appPreferences.fetch(function (c) {
                if (null == c)
                    b = !0;
                else {
                    var d = parseInt(c);
                    2 > d && (b = !0)
                }
                a(b)
            }, function (c) {
                console.log(c), a(b)
            }, "db_version")
        }, d.init = function () {
            "undefined" != typeof device && (u = !0), u ? v = sqlitePlugin.openDatabase({name: "mina.db", location: 2, createFromLocation: 1}) : w()
        }, d.closeDb = function () {
            null != v && v.close()
        }, d.getKana = function (b) {
            if (u) {
                var d = squel.select().from("'kana'").toString();
                c(d, b)
            } else
                a({url: "chucai/json_chucai", method: "GET"}).success(function (a) {
                    b(a)
                }).error(function (a) {
                    b(null)
                })
        }, d.getPharse = function (b, d) {
            if (u) {
                var e = squel.select().from("'phrase'").where("category_id = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getPharse.php", method: "GET", params: {categoryid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getIKanji = function (b, d) {
            if (u) {
                var e = squel.select().from("'ikanji'").where("lesson = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getIKanji.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getKanji = function (b, d, e) {
            if (u) {
                var f = squel.select().from("'kanji'").where("id >= " + b + " and id <= " + d).toString();
                c(f, e)
            } else
                a({url: "api/getKanji.php", method: "GET", params: {from: b, to: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.getKotoba = function (b, d) {
            if (u) {
                var e = squel.select().from("'kotoba'").where("lesson_id = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getKotoba.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getGrammar = function (b, d) {
            if (u) {
                var e = squel.select().from("'grammar'").where("lesson_id = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getGrammar.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getKaiwa = function (b, d) {
            if (u) {
                var e = squel.select().from("'kaiwa'").where("lesson_id = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getKaiwa.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getMondai = function (b, d) {
            if (u) {
                var e = squel.select().from("'mondai'").where("lesson_id = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getMondai.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getBunkei = function (b, d) {
            if (u) {
                var e = squel.select().from("'bunkei'").where("lesson_id = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getBunkei.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getReibun = function (b, d) {
            if (u) {
                var e = squel.select().from("'reibun'").where("lesson_id = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getReibun.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getReference = function (b, d) {
            if (u) {
                var e = squel.select().from("'reference'").where("lesson_id = " + b).toString();
                c(e, d)
            } else
                a({url: "api/getReference.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getLessionJLPT = function (b, d) {
            if (u) {
                var e = squel.select().from("'jlpt'").where("category = " + b).toString();
                c(e, function (a) {
                    if (null == a)
                        return void d(null);
                    for (var b = [], c = [], e = 0; 15 > e; ) {
                        var f = Math.floor(Math.random() * a.length);
                        -1 == c.indexOf(f) && (c.push(f), b.push(a[f]), e++)
                    }
                    d(b)
                })
            } else
                a({url: "api/getLessionJLPT.php", method: "GET", params: {lessonid: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getListenLession = function (b, d, e) {
            if (u) {
                var f = squel.select().from("'listen'").where("lesson = " + b + " and type like '" + d + "%'").toString();
                c(f, e)
            } else
                a({url: "api/getListenLession.php", method: "GET", params: {lesson: b, type: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.getDoushi = function (b, d) {
            var e = 10;
            if (u) {
                var f = e * b - e, g = f + e, h = squel.select().from("duoshi").where("id >= " + f + " and id < " + g).toString();
                c(h, d)
            } else
                a({url: "api/getDoushi.php", method: "GET", params: {page: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getJitadoushi = function (b) {
            if (u) {
                var d = squel.select().from("jitadoushi").toString();
                c(d, b)
            } else
                a({url: "api/getJitadoushi.php", method: "GET"}).success(function (a) {
                    b(a)
                }).error(function (a) {
                    b(null)
                })
        }, d.getKanjiset = function (b, d) {
            var e = 10;
            if (u) {
                var f = e * b - e, g = f + e, h = squel.select().from("kanjiset").where("id >= " + f + " and id < " + g).toString();
                c(h, d)
            } else
                a({url: "api/getKanjiset.php", method: "GET", params: {page: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getDoushiQuery = function (b, d, e) {
            if (u) {
                var f = squel.select().from("duoshi").where("id >=" + d).where("tei like '%" + b + "%' or roumaji like '%" + b + "%' or mean like '%" + b + "%' or  umean like '%" + b + "%'").limit(11).toString();
                c(f, function (a) {
                    var b = [];
                    if (null != a && 11 == a.length) {
                        var c = a.pop();
                        b.data = a, b.isMore = c.id
                    } else
                        b.data = a, b.isMore = 0;
                    e(b)
                })
            } else
                a({url: "api/getDoushiQuery.php", method: "GET", params: {query: b, start: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.getKanjisetQuery = function (b, d, e) {
            if (u) {
                var f = squel.select().from("kanjiset").where("id >=" + d).where("'set' like '%" + b + "%' or 'name' like '%" + b + "%' or u_name like '%" + b + "%' or mean like '%" + b + "%' or u_mean like '%" + b + "%'").limit(11).toString();
                c(f, function (a) {
                    var b = [];
                    if (null != a && 11 == a.length) {
                        var c = a.pop();
                        b.data = a, b.isMore = c.id
                    } else
                        b.data = a, b.isMore = 0;
                    e(b)
                })
            } else
                a({url: "api/getKanjisetQuery.php", method: "GET", params: {query: b, start: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.getJitadoushiQuery = function (b, d) {
            if (u) {
                var e = squel.select().from("jitadoushi").where("'jidoushi' like '%" + b + "%' or 'ji_mean' like '%" + b + "%' or ji_umean like '%" + b + "%' or tadoushi like '%" + b + "%' or ta_mean like '%" + b + "%' or ta_umean like '%" + b + "%'").toString();
                c(e, d)
            } else
                a({url: "api/getJitadoushiQuery.php", method: "GET", params: {query: b}}).success(function (a) {
                    d(a)
                }).error(function (a) {
                    d(null)
                })
        }, d.getSearchGrammar = function (b, d, e) {
            if (u) {
                var f = squel.select().from("grammar").where("id >=" + d).where("name like '%" + b + "%' or uname like '%" + b + "%'").limit(11).toString();
                c(f, function (a) {
                    var b = [];
                    if (null != a && 11 == a.length) {
                        var c = a.pop();
                        b.data = a, b.isMore = c.id
                    } else
                        b.data = a, b.isMore = 0;
                    e(b)
                })
            } else
                a({url: "api/getSearchGrammar.php", method: "GET", params: {query: b, start: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.getSearchKotoba = function (b, d, e) {
            if (u) {
                var f = squel.select().from("kotoba").where("id >=" + d).where("'hiragana' like '%" + b + "%' or 'mean' like '%" + b + "%' or mean_unsigned like '%" + b + "%' or roumaji like '%" + b + "%'").limit(11).toString();
                c(f, function (a) {
                    var b = [];
                    if (null != a && 11 == a.length) {
                        var c = a.pop();
                        b.data = a, b.isMore = c.id
                    } else
                        b.data = a, b.isMore = 0;
                    e(b)
                })
            } else
                a({url: "api/getSearchKotoba.php", method: "GET", params: {query: b, start: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.getSearchKanji = function (b, d, e) {
            if (u) {
                var f = squel.select().from("kanji").where("id >=" + d).where("'word' like '%" + b + "%' or 'cn_mean' like '%" + b + "%' or ucn_mean like '%" + b + "%' or vi_mean like '%" + b + "%' or uvi_mean like '%" + b + "%'").limit(11).toString();
                c(f, function (a) {
                    var b = [];
                    if (null != a && 11 == a.length) {
                        var c = a.pop();
                        b.data = a, b.isMore = c.id
                    } else
                        b.data = a, b.isMore = 0;
                    e(b)
                })
            } else
                a({url: "api/getSearchKanji.php", method: "GET", params: {query: b, start: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.getSearchCompharse = function (b, d, e) {
            if (u) {
                var f = squel.select().from("phrase").where("id >=" + d).where("'vietnamese' like '%" + b + "%' or 'vietnamese_un' like '%" + b + "%' or pinyin like '%" + b + "%' or japanese like '%" + b + "%'").limit(11).toString();
                c(f, function (a) {
                    var b = [];
                    if (null != a && 11 == a.length) {
                        var c = a.pop();
                        b.data = a, b.isMore = c.id
                    } else
                        b.data = a, b.isMore = 0;
                    e(b)
                })
            } else
                a({url: "api/getSearchCompharse.php", method: "GET", params: {query: b, start: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.getSearchIKanji = function (b, d, e) {
            if (u) {
                var f = squel.select().from("ikanji").where("id >=" + d).where("'word' like '%" + b + "%' or 'vi_mean' like '%" + b + "%' or uvi_mean like '%" + b + "%' or cn_mean like '%" + b + "%' or ucn_mean like '%" + b + "%'").limit(11).toString();
                c(f, function (a) {
                    var b = [];
                    if (null != a && 11 == a.length) {
                        var c = a.pop();
                        b.data = a, b.isMore = c.id
                    } else
                        b.data = a, b.isMore = 0;
                    e(b)
                })
            } else
                a({url: "api/getSearchIKanji.php", method: "GET", params: {query: b, start: d}}).success(function (a) {
                    e(a)
                }).error(function (a) {
                    e(null)
                })
        }, d.shuffleArray = function (a) {
            for (var b, c, d = a.length; d; )
                c = Math.floor(Math.random() * d--), b = a[d], a[d] = a[c], a[c] = b;
            return a
        }, d.randomChoice = function (a, b, c) {
            var e = d.shuffleArray(a), f = [];
            if (e.length > 20)
                for (var g = 0; 20 > g; g++)
                    f.push(e[g]);
            else
                f = e;
            for (var h = 0; h < f.length; h++) {
                f[h].question = f[h][b], f[h].result = f[h][c];
                for (var i = [], g = 0; 3 > g; ) {
                    var j = Math.floor(Math.random() * f.length), k = f[j][c];
                    -1 == i.indexOf(k) && k != f[h][c] && (i.push(k), g++)
                }
                i.push(f[h][c]), f[h].answer = d.shuffleArray(i)
            }
            return f
        }, d.rememberKanji = function (a, b, d) {
            var e = "", f = "";
            f = 1 == a ? '"remember"' : "null", "ikanji" == d ? e = "update ikanji set tag = " + f + " where id = " + b : "advance" == d && (e = "update kanji set tag = " + f + " where id = " + b), c(e, function (a) {
                console.log(a)
            })
        }, d
    }]), angular.module("maziiLearn", ["ui.router", "ngAnimate", "ui.bootstrap", "infinite-scroll", "maziiLearn.service.data", "maziiLearn.localStorage", "templates-main"]).config(["$stateProvider", "$urlRouterProvider", "$sceProvider", "$httpProvider", "$compileProvider", function (a, b, c, d, e) {
        c.enabled(!1), d.useApplyAsync(!0), e.debugInfoEnabled(!1), b.otherwise("/alphabet"), a.state("advankanji", {url: "/advankanji", views: {"main-content": {templateUrl: "views/advankanji/main.html", controller: "AdvanKanjiController"}}}).state("alphabet", {url: "/alphabet", views: {"main-content": {templateUrl: "views/alphabet/main.html", controller: "AlphabetController"}}}).state("basickanji", {url: "/basickanji", views: {"main-content": {templateUrl: "views/basickanji/main.html", controller: "BasicKanjiController"}}}).state("compharse", {url: "/compharse", views: {"main-content": {templateUrl: "views/compharse/main.html", controller: "CompharseController"}}}).state("favorites", {url: "/favorites", views: {"main-content": {templateUrl: "views/favorites/main.html", controller: "FavoritesController"}}}).state("jlpttest", {url: "/jlpttest", views: {"main-content": {templateUrl: "views/jlpttest/main.html", controller: "JlpttestController"}}}).state("test", {url: "/test/:id?:title", views: {"main-content": {templateUrl: "views/jlpttest/test/main.html", controller: "TestController"}}}).state("minna", {url: "/minna", views: {"main-content": {templateUrl: "views/minano/main.html", controller: "MinnaController"}}}).state("search", {url: "/search", views: {"main-content": {templateUrl: "views/search/main.html", controller: "SearchController"}}}).state("settings", {url: "/settings", views: {"main-content": {templateUrl: "views/settings/main.html", controller: "SettingsController"}}}).state("reference", {url: "/reference", views: {"main-content": {templateUrl: "views/reference/main.html", controller: "ReferenceController"}}}).state("duoshi", {url: "/duoshi", views: {"main-content": {templateUrl: "views/reference/duoshi/main.html", controller: "DuoshiController"}}}).state("jitaduoshi", {url: "/jitaduoshi", views: {"main-content": {templateUrl: "views/reference/jitaduoshi/main.html", controller: "JitaduoshiController"}}}).state("kanjiset", {url: "/kanjiset", views: {"main-content": {templateUrl: "views/reference/kanjiset/main.html", controller: "KanjisetController"}}})
    }]).run(["$rootScope", "$state", "$timeout", "$stateParams", "$location", "$window", "dataServ", "localstoreServ", function (a, b, c, d, e, f, g, h) {
        function i() {
            $("body").scrollTop() > 0 && $("body").animate({scrollTop: 0}, 500)
        }
        $("body").addClass("hidden"), a.isContact = !1;
        var j = "", k = h.getItem("sharefacebook");
        a.$on("$stateChangeSuccess", function (a, b, c, d, e) {
            $(".list-group-item").removeClass("active-menu-left"), $("." + b.name).addClass("active-menu-left"), j = b.name, $(".ip-header").val(""), $(window).width() <= 768 && ($(".left-menu-mobile").animate({left: "-250px"}, 200), $(".cover").hide()), $(".contact-content").hide()
        }), a.showContact = function () {
            i(), 0 == $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").addClass("left-menu-cover"), a.isContact = !a.isContact, a.isContact ? ($(".list-group-item").removeClass("active-menu-left"), $(".contact-content").show()) : ($("." + j).addClass("active-menu-left"), $(".contact-content").hide())
        }, a.shareWebsite = function (a) {
            "modal" == a && $("#myShare").modal("hide"), h.setItem("sharefacebook", "sharefacebook"), window.open("https://www.facebook.com/sharer/sharer.php?u=http://mina.mazii.net/", "sharer", "width=626,height=436, left:0, right:0"), trackView("sharefacebook")
        }, a.notShareWebsite = function () {
            trackView("notsharefacebook")
        }, a.showMenuLeft = function () {
            $(".cover").show(), $(".left-menu-mobile").animate({left: "0px"}, 200)
        }, a.closePanel = function () {
            $(".left-menu-mobile").animate({left: "-250px"}, 200), $(".cover").hide(100)
        }, a.activeMenu = function (c) {
            $(".contact-content").hide(), j = c, a.isContact = !1, $("." + j).addClass("active-menu-left"), b.go(c)
        }, a.checkInputSearch = function () {
            $(".list-group-item").removeClass("active-menu-left"), $(".contact-content").hide(), a.isContact = !1, b.go("search")
        }, null == k && c(function () {
            $("#myShare").modal({backdrop: "static", keyboard: !1})
        }, 18e4), $("body").removeClass("hidden")
    }]).directive("ngEnter", function () {
    return function (a, b, c) {
        b.bind("keydown keypress", function (b) {
            13 === b.which && (a.$apply(function () {
                a.$eval(c.ngEnter)
            }), b.preventDefault())
        })
    }
}).directive("focusMe", ["$timeout", function (a) {
        return{link: function (b, c, d) {
                a(function () {
                    c[0].focus()
                }, 500)
            }}
    }]), angular.module("maziiLearn").directive("ngKanjiDraw", function () {
    return{restrict: "E", templateUrl: "components/kanji-draw/kanji-draw-template.html", scope: {data: "=data"}, controller: ["$rootScope", "$scope", "$http", function (a, b, c) {
                function d() {
                    var a = {skipLoad: !1, autoplay: !0, height: 250, width: 250, viewBox: {x: 0, y: 0, w: 125, h: 125}, step: .01, stroke: {animated: {drawing: !0, erasing: !0}, order: {visible: !0, attr: {"font-size": "8", fill: "#33B5E5"}}, attr: {active: "#CC0000", stroke: "random", "stroke-width": 3, "stroke-linecap": "round", "stroke-linejoin": "round"}}, grid: {show: !0, attr: {stroke: "#CCCCCC", "stroke-width": .5, "stroke-dasharray": "--"}}, svg: null};
                    return a
                }
                b.draw = function () {
                    $("#image-holder").dmak(b.data, d())
                }, b.resetDrawKanjiStroke = function () {
                    var a = $("#image-holder");
                    a.html(""), a.data("plugin_dmak") && (a.dmak("reset"), a.data("plugin_dmak", null)), b.draw()
                }, b.$watch("data", function (a, c) {
                    a != c && b.resetDrawKanjiStroke()
                }), b.resetDrawKanjiStroke()
            }]}
}), angular.module("maziiLearn").controller("AdvanKanjiController", ["$rootScope", "$scope", "localstoreServ", "dataServ", "$timeout", function (a, b, c, d, e) {
        function f() {
            $(".flip-container").removeClass("view-back");
            var a = parseInt(b.groupActive);
            c.setItem("advanKanji", a), d.getKanji(a, a + 99, function (a) {
                for (var c = a.length, d = 0; c > d; d++) {
                    var e = a[d].cn_mean.split(",");
                    a[d].cn_mean_new = e[0]
                }
                b.datas = a, i()
            })
        }
        function g() {
            "$apply" != b.$root.$$phase && "$digest" != b.$root.$$phase && b.$apply()
        }
        function h(a) {
            if (null == a || 0 == a.length)
                b.kanjiFlashCard = o;
            else {
                for (var c = o.length, d = [], e = 0; c > e; e++) {
                    for (var f = 0, g = 0; g < a.length; g++)
                        o[e].id == a[g].id && f++;
                    0 == f && (o[e].rememberflashcard = 0, d.push(o[e]))
                }
                b.kanjiFlashCard = d
            }
        }
        function i() {
            if (1 == b.isFlashCard) {
                n = [], o = [], b.size = b.datas.length;
                for (var a = 0; a < b.size; a++)
                    n[a] = a;
                n = k(n);
                for (var a = 0; a < n.length; a++)
                    o.push(b.datas[n[a]]);
                h(m), b.kanjiFlashCard[0].active = !0
            }
        }
        function j() {
            $("body").scrollTop() > 0 && $("body").animate({scrollTop: 0}, 500)
        }
        function k(a) {
            for (var b, c, d = a.length; d; )
                c = Math.floor(Math.random() * d--), b = a[d], a[d] = a[c], a[c] = b;
            return a
        }
        b.title = "1945 từ Kanji nâng cao";
        var l, m = c.getItem("rememberadvankanji"), n = [], o = [];
        b.groupActive = 1, b.detailAdvanKanji = null, b.isFlashCard = !1, b.radio = "forget", b.kanjiFlashCard = [], b.dataAvailable = !0, l = c.getItem("advanKanji"), null != l && (b.groupActive = l), b.groups = {};
        for (var p = 1; 19 >= p; p++)
            b.groups[100 * (p - 1) + 1] = 100 * p;
        b.groups[1901] = 1945, b.selectLessonGroup = function (a) {
            j(), b.groupActive = a, $(".item-subleft-menu").removeClass("item-subleft-menu-active"), $(".itemLesson" + b.groupActive).addClass("item-subleft-menu-active"), f()
        }, b.viewDetailAdvanKanji = function (a) {
            $(".advankanji-item").removeClass("advankanji-item-active"), $(".advankanji-content-item" + a).addClass("advankanji-item-active");
            for (var c = b.datas.length, d = 0; c > d; d++)
                if (b.datas[d].id == a) {
                    if (b.detailAdvanKanji = b.datas[d], b.advanKanji = b.detailAdvanKanji.word, "" != b.datas[d].note) {
                        for (var f = b.datas[d].note.split("※"), g = [], d = 0; d < f.length; d++) {
                            var h = f[d].split("∴");
                            g.push(h)
                        }
                        b.detailAdvanKanji.noteDetail = g
                    }
                    break
                }
            e(function () {
                $("#myAdvanKanji").modal()
            }, 10)
        }, b.showFlashCardBasickanji = function () {
            b.isFlashCard = !b.isFlashCard, i()
        }, b.rememberAdvankanji = function (a, b) {
            var d = a.id;
            if (1 != a.rememberflashcard ? (a.rememberflashcard = 1, $(b.target).addClass("remember")) : (a.rememberflashcard = 0, $(b.target).removeClass("remember")), m = c.getItem("rememberadvankanji"), null == m)
                m = [], m.push({id: d}), c.setItem("rememberadvankanji", m);
            else {
                for (var e = m.length, f = 0; e > f; f++)
                    if (m[f].id == d)
                        return m.splice(f, 1), void c.setItem("rememberadvankanji", m);
                m.push({id: d}), c.setItem("rememberadvankanji", m)
            }
        }, b.changeTypeFlashCard = function (a) {
            $(".flip-container").removeClass("view-back"), b.dataAvailable = !1, m = c.getItem("rememberadvankanji"), e(function () {
                switch (a) {
                    case"forget":
                        h(m);
                        break;
                    case"remember":
                        if (null == m || 0 == m.length)
                            b.kanjiFlashCard = [];
                        else {
                            for (var c = o.length, d = [], e = 0; c > e; e++)
                                for (var f = 0; f < m.length; f++)
                                    o[e].id == m[f].id && (o[e].rememberflashcard = 1, d.push(o[e]), d[d.length - 1].active = !1);
                            b.kanjiFlashCard = d
                        }
                        break;
                    case"all":
                        if (null == m || 0 == m.length)
                            b.kanjiFlashCard = o;
                        else {
                            for (var c = o.length, e = 0; c > e; e++)
                                for (var f = 0; f < m.length; f++)
                                    o[e].id == m[f].id && (o[e].rememberflashcard = 1);
                            b.kanjiFlashCard = o
                        }
                }
                if (b.size = b.kanjiFlashCard.length, 0 != b.size) {
                    for (var e = 0; e < b.size; e++)
                        o[e].active = !1;
                    b.kanjiFlashCard[0].active = !0
                }
                g(), b.dataAvailable = !0
            }, 100)
        }, b.flip = function (a, b) {
            $(b.currentTarget).is(".button-register") || ($(b.currentTarget).hasClass("view-back") ? $(b.currentTarget).removeClass("view-back") : $(b.currentTarget).addClass("view-back"))
        }, f(), e(function () {
            $(".itemLesson" + b.groupActive).addClass("item-subleft-menu-active"), 0 == $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").addClass("left-menu-cover"), 0 == $(".main-content").hasClass("main-content-cover") && $(".main-content").addClass("main-content-cover")
        }, 100), trackView("advankanji")
    }]), angular.module("maziiLearn").controller("AlphabetController", ["$rootScope", "$scope", "$state", "dataServ", "$timeout", "localstoreServ", function (a, b, c, d, e, f) {
        function g(a, b, c) {
            for (var d = [], e = [], f = 0; f < a.length; f++)
                d[f] = f;
            d = h(d);
            for (var f = 0; 20 > f; f++)
                e.push(a[d[f]]);
            for (var g = 0; g < e.length; g++) {
                e[g].question = e[g][b], e[g].result = e[g][c];
                for (var i = [], f = 0; 3 > f; ) {
                    var j = Math.floor(Math.random() * (a.length - 1)), k = a[j][c];
                    -1 == i.indexOf(k) && k != e[g][c] && (i.push(k), f++)
                }
                i.push(e[g][c]), e[g].answer = h(i)
            }
            return e
        }
        function h(a) {
            for (var b, c, d = a.length; d; )
                c = Math.floor(Math.random() * d--), b = a[d], a[d] = a[c], a[c] = b;
            return a
        }
        function i(a) {
            $(".kana-item-alphabet").removeClass("item-alphabet-active"), $(".alphabet-content-item" + a).addClass("item-alphabet-active");
            for (var c = b.datas.length, d = 0; c > d; d++)
                if (b.datas[d].id == a) {
                    b.showKatakana ? b.kanjiAlphabet = b.datas[d].kata : b.kanjiAlphabet = b.datas[d].hira, b.detailAlphabet = {}, b.detailAlphabet = b.datas[d];
                    var e = [];
                    if (0 != b.datas[d].example.length)
                        for (var f = b.datas[d].example.split("\n"), d = 0; d < f.length; d++) {
                            var g = f[d].split("∴");
                            e.push(g)
                        }
                    b.detailAlphabet.detailExample = e;
                    break
                }
            t || b.playAudio(b.detailAlphabet.romaji), l()
        }
        function j() {
            $("body").scrollTop() > 0 && $("body").animate({scrollTop: 0}, 500)
        }
        function k() {
            $(".music-alphabet").removeClass("music-alphabet-load"), null != p && (p[0].pause(), p[0].currentTime =f 0, p = null, $("#music-alphabet>source").attr("src", ""))
        }
        function l() {
            "$apply" != b.$root.$$phase && "$digest" != b.$root.$$phase && b.$apply()
        }
        b.tabs = ["Hiragana", "Katakana", "Kiểm tra"], b.showKatakana = !1, b.kanjiAlphabet = "", b.detailAlphabet = [], b.isTest = !1, b.buttonDisabled = !1, b.trueAnswer = 0, b.size = 0, b.showTest = !1, b.showNext = 0;
        var m, n, o = [], p = null, q = 1, r = null, s = 0, t = !0;
        r = f.getItem("alphabet-mina"), null == r ? (r = 0, f.setItem("alphabet-mina", r)) : 2 == r && (b.isTest = !0), b.changeType = function (a) {
            t = !0, j(), k(), b.showTest = !1, $(".item-header").removeClass("item-header-active"), o = [], 0 == a ? (b.isTest = !1, b.showKatakana = !1, r = 0, e(function () {
                i(q)
            }, 100)) : 1 == a ? (b.isTest = !1, b.showKatakana = !0, e(function () {
                i(q)
            }, 100), r = 1) : 2 == a && (r = 2, b.isTest = !0, b.showNext = 0, b.buttonDisabled = !1), $(".tabalphabet" + a).addClass("item-header-active"), f.setItem("alphabet-mina", r)
        }, b.getClass = function (a) {
            return $(window).width() > 768 ? "" : (a = parseInt(a), a >= 71 ? "forcespace" : "")
        }, b.viewDetailAlphabet = function (a) {
            t = !1, q = a, k(), i(a)
        }, b.testAlphabet = function (a) {
            o = g(b.datas, a, "romaji"), b.showTest = !0, b.size = o.length, b.indexActive >= b.datas.length - 1 || ($(".content-test-alphabet div:first").animate({left: "-150%"}, 350, function () {
                $(this).css("left", "150%"), $(this).insertAfter(".item-test-alphabet")
            }), $(".content-test-alphabet div:first").next().animate({left: "0"}, 300), e(function () {
                b.testActive = o[s], b.testActive.idx = s
            }, 100))
        }, b.chooseAnswer = function (a, c, d, e) {
            $(".card-choice").removeClass("box-choice"), $(".testAlphabet" + c).addClass("box-choice"), b.buttonDisabled = !0, m = c, n = d, s = a
        }, b.checkTest = function () {
            m == n ? (b.trueAnswer++, $(".progress-bar").animate({width: b.trueAnswer / b.size * 100 + "%"}, 100), $(".box-notify-correct").addClass("box-notify-show")) : $(".box-notify-fails").addClass("box-notify-show"), b.testActive.idx != b.size - 1 ? b.showNext = 1 : b.showNext = 2
        }, b.next = function () {
            $(".box-notify").removeClass("box-notify-show"), $(".item-content-alphabet div:first").next().show(), $(".item-content-alphabet div:first").animate({left: "-150%"}, 300, function () {
                $(this).css("left", "150%"), $(this).appendTo(".item-content-alphabet"), $(this).hide()
            }), $(".item-content-alphabet div:first").next().animate({left: "0"}, 300), e(function () {
                b.showNext = 0, b.buttonDisabled = !1, b.testActive = o[++s], b.testActive.idx = s, $(".card-choice").removeClass("box-choice")
            }, 300)
        }, b.finish = function () {
            b.showNext = 3, $(".box-notify").removeClass("box-notify-show"), $(".finish-test-alphabet").fadeIn(3e3)
        }, b.benginTest = function () {
            $(".box-notify").removeClass("box-notify-show"), $(".finish-test-alphabet").hide(), $(".content-test-alphabet div:first").animate({left: "-150%"}, 350, function () {
                $(this).css("left", "150%"), $(this).insertAfter(".select-alphabet")
            }), $(".content-test-alphabet div:first").next().animate({left: "0"}, 300), e(function () {
                b.showTest = !1, b.buttonDisabled = !1, b.showNext = 0, b.trueAnswer = 0, s = 0
            }, 100)
        }, b.playAudio = function (a) {
            var b = "db/alphabet/" + a + ".mp3";
            $(".music-alphabet").addClass("music-alphabet-load"), null == p && (p = $("#music-alphabet"), $("#music-alphabet>source").attr("src", b), p[0].autoplay = !0, p[0].load(), p[0].onended = function () {
                k()
            })
        }, d.getKana(function (a) {
            b.datas = a, b.changeType(r)
        }), $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").removeClass("left-menu-cover"), $(".main-content").hasClass("main-content-cover") && $(".main-content").removeClass("main-content-cover"), e(function () {
            $(".tabalphabet" + r).addClass("item-header-active"), $(".alphabet-content-item" + q).addClass("item-alphabet-active")
        }, 100), trackView("alphabet")
    }]), angular.module("maziiLearn").controller("BasicKanjiController", ["$rootScope", "$scope", "localstoreServ", "dataServ", "$timeout", function (a, b, c, d, e) {
        function f() {
            var a = parseInt(b.activeId);
            c.setItem("basicKanji", a), d.getIKanji(a, function (a) {
                b.datas = a, i(), g()
            })
        }
        function g() {
            "$apply" != b.$root.$$phase && "$digest" != b.$root.$$phase && b.$apply()
        }
        function h(a) {
            if (null == a || 0 == a.length)
                b.kanjiFlashCard = n;
            else {
                for (var c = n.length, d = [], e = 0; c > e; e++) {
                    for (var f = 0, g = 0; g < a.length; g++)
                        n[e].id == a[g].id && f++;
                    0 == f && (n[e].rememberflashcard = 0, d.push(n[e]))
                }
                b.kanjiFlashCard = d
            }
        }
        function i() {
            if (1 == b.isFlashCard) {
                m = [], n = [], b.size = b.datas.length;
                for (var a = 0; a < b.size; a++)
                    m[a] = a;
                m = j(m);
                for (var a = 0; a < m.length; a++)
                    n.push(b.datas[m[a]]);
                h(o), b.kanjiFlashCard[0].active = !0
            }
        }
        function j(a) {
            for (var b, c, d = a.length; d; )
                c = Math.floor(Math.random() * d--), b = a[d], a[d] = a[c], a[c] = b;
            return a
        }
        function k() {
            $("body").scrollTop() > 0 && $("body").animate({scrollTop: 0}, 500)
        }
        b.title = "512 từ Kanji cơ bản", b.lessonIds = [];
        var l, m = [], n = [];
        b.activeId = 1, b.detailKanji = null, b.isFlashCard = !1, b.kanjiFlashCard = [], b.radio = "forget", b.dataAvailable = !0, l = c.getItem("basicKanji"), null != l && (b.activeId = l);
        for (var o = c.getItem("rememberkanji"), p = 1; 32 >= p; p++)
            10 > p ? b.lessonIds.push("Bài 0" + p) : b.lessonIds.push("Bài " + p);
        b.selectLessonIkanji = function (a) {
            k(), $(".flip-container").removeClass("view-back"), b.activeId = a, $(".item-subleft-menu").removeClass("item-subleft-menu-active"), $(".itemLesson" + b.activeId).addClass("item-subleft-menu-active"), f()
        }, b.rememberKanji = function (a, b) {
            var d = a.id;
            if (1 != a.rememberflashcard ? ($(b.target).addClass("remember"), a.rememberflashcard = 1) : ($(b.target).removeClass("remember"), a.rememberflashcard = 0), o = c.getItem("rememberkanji"), null == o)
                o = [], o.push({id: d}), c.setItem("rememberkanji", o);
            else {
                for (var e = o.length, f = 0; e > f; f++)
                    if (o[f].id == d)
                        return o.splice(f, 1), void c.setItem("rememberkanji", o);
                o.push({id: d}), c.setItem("rememberkanji", o)
            }
        }, b.changeTypeFlashCard = function (a) {
            $(".flip-container").removeClass("view-back"), b.dataAvailable = !1, o = c.getItem("rememberkanji"), e(function () {
                switch (a) {
                    case"forget":
                        h(o);
                        break;
                    case"remember":
                        if (null == o || 0 == o.length)
                            b.kanjiFlashCard = [];
                        else {
                            for (var c = n.length, d = [], e = 0; c > e; e++)
                                for (var f = 0; f < o.length; f++)
                                    n[e].id == o[f].id && (n[e].rememberflashcard = 1, d.push(n[e]), d[d.length - 1].active = !1);
                            b.kanjiFlashCard = d
                        }
                        break;
                    case"all":
                        if (null == o || 0 == o.length)
                            b.kanjiFlashCard = n;
                        else {
                            for (var c = n.length, e = 0; c > e; e++)
                                for (var f = 0; f < o.length; f++)
                                    n[e].id == o[f].id && (n[e].rememberflashcard = 1);
                            b.kanjiFlashCard = n
                        }
                }
                if (b.size = b.kanjiFlashCard.length, 0 != b.size) {
                    for (var e = 0; e < b.size; e++)
                        n[e].active = !1;
                    b.kanjiFlashCard[0].active = !0
                }
                g(), b.dataAvailable = !0
            }, 100)
        }, b.viewDetailIKanji = function (a) {
            var c = b.datas.length;
            b.detailKanji = [];
            for (var d = 0; c > d; d++)
                if (b.datas[d].id == a) {
                    b.detailKanji = b.datas[d], b.kanjiSample = b.detailKanji.word;
                    var f = [];
                    if ("" != b.datas[d].note)
                        for (var g = b.datas[d].note.split("※"), d = 0; d < g.length; d++) {
                            var h = g[d].split("∴");
                            f.push(h)
                        }
                    b.detailKanji.detailKanjiNote = f;
                    break
                }
            e(function () {
                $("#myIKanji").modal()
            }, 10)
        }, b.showFlashCardBasickanji = function () {
            b.isFlashCard = !b.isFlashCard, i()
        }, b.flip = function (a, b) {
            $(b.currentTarget).is(".button-register") || ($(b.currentTarget).hasClass("view-back") ? $(b.currentTarget).removeClass("view-back") : $(b.currentTarget).addClass("view-back"))
        }, f(), e(function () {
            $(".itemLesson" + b.activeId).addClass("item-subleft-menu-active"), 0 == $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").addClass("left-menu-cover"), 0 == $(".main-content").hasClass("main-content-cover") && $(".main-content").addClass("main-content-cover")
        }, 100), trackView("basickanji")
    }]), angular.module("maziiLearn").controller("CompharseController", ["$rootScope", "$scope", "localstoreServ", "dataServ", "$timeout", function (a, b, c, d, e) {
        function f() {
            $("body").scrollTop() > 0 && $("body").animate({scrollTop: 0}, 500)
        }
        function g() {
            c.setItem("compharse", b.categorySelected), d.getPharse(parseInt(b.categorySelected), function (a) {
                b.datas = a
            })
        }
        function h() {
            $(".music-icon").removeClass("music-icon-load"), null != j && (j[0].pause(), j[0].currentTime = 0, j = null, $("#music-compharse>source").attr("src", ""))
        }
        b.categorySelected = 1;
        var i, j = null;
        b.categories = ["Chào hỏi", "Hội thoại", "Số đếm", "Ngày tháng", "Phương hướng", "Giao thông", "Chỗ ở", "Ăn uống", "Mua sắm", "Màu sắc", "Thành phố", "Tên nước", "Du lịch", "Gia đình", "Hẹn hò", "Khẩn cấp", "Đau ốm", "Thành ngữ"], b.title = "1000 mẫu câu giao tiếp", i = c.getItem("compharse"), null != i && (b.categorySelected = i), b.selectLessonCompharse = function (a) {
            f(), b.categorySelected = a, $(".item-subleft-menu").removeClass("item-subleft-menu-active"), $(".itemLesson" + b.categorySelected).addClass("item-subleft-menu-active"), g()
        }, b.clickPhrase = function (a, b) {
            var c = b.currentTarget;
            if (h(), $(".phrase").removeClass("open"), -1 != c.className.indexOf("open"))
                c.className = c.className.replace("open", "");
            else {
                if ($(".list-phrase").removeClass("open"), c.className += " open", null != j)
                    return;
                $(".music-icon").addClass("music-icon-load");
                var d = "db/phrase/" + a + ".mp3";
                if ("undefined" != typeof device)
                    return void utilServ.playAudio(d, function () {
                        h()
                    });
                j = $("#music-compharse"), $("#music-compharse>source").attr("src", d), j[0].autoplay = !0, j[0].load(), j[0].onended = function () {
                    h()
                }, j[0].play()
            }
        }, b.playAudio = function (a, b) {
            var c = "db/phrase/" + a + ".mp3";
            b.stopImmediatePropagation();
            var d = b.currentTarget;
            return d.className += " music-icon-load", "undefined" != typeof device ? void utilServ.playAudio(c, function () {
                h()
            }) : void(null == j && (j = $("#music-compharse"), $("#music-compharse>source").attr("src", c), j[0].autoplay = !0, j[0].load(), j[0].onended = function () {
                h()
            }, j[0].play()))
        }, g(), e(function () {
            $(".itemLesson" + b.categorySelected).addClass("item-subleft-menu-active"), 0 == $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").addClass("left-menu-cover"), 0 == $(".main-content").hasClass("main-content-cover") && $(".main-content").addClass("main-content-cover")
        }, 100), trackView("commonphrase")
    }]), angular.module("maziiLearn").controller("JlpttestController", ["$rootScope", "$scope", "$state", "$timeout", "dataServ", "$window", "localstoreServ", function (a, b, c, d, e, f, g) {
        function h() {
            $(".box-notify").removeClass("box-notify-show"), $(".card-choice").removeClass("box-choice"), $(".finish-test-jlpt").hide(), $(".progress-bar").animate({width: "0%"}, 100), m = 0, n = 0, b.buttonDisabled = !1, b.showNext = 0
        }
        function i(a) {
            for (var b, c, d = a.length; d; )
                c = Math.floor(Math.random() * d--), b = a[d], a[d] = a[c], a[c] = b;
            return a
        }
        function j(a) {
            g.setItem("LessionJLPT", a), e.getLessionJLPT(a, function (a) {
                for (var c = i(a), d = 0; d < c.length; d++)
                    if ("" != c[d].answer) {
                        var e = c[d].answer.split("※");
                        c[d].answerNew = e
                    }
                b.datas = c, b.size = c.length, b.jlptActive = b.datas[m], b.trueAnswer = 0
            })
        }
        b.title = "Luyện thi JLPT", b.lessionJLPT = [{name: "N5 Ngữ pháp", id: 2}, {name: "N5 Từ vựng", id: 12}, {name: "N5 Kanji", id: 9}, {name: "N4 Ngữ pháp", id: 15}, {name: "N4 Từ vựng", id: 4}, {name: "N4 Kanji", id: 10}, {name: "N3 Ngữ pháp", id: 3}, {name: "N3 Từ vựng", id: 6}, {name: "N3 Kanji", id: 13}, {name: "N2 Ngữ pháp", id: 5}, {name: "N2 Từ vựng", id: 8}, {name: "N2 Kanji", id: 11}, {name: "N1 Ngữ pháp", id: 14}, {name: "N1 Từ vựng", id: 7}, {name: "N1 Kanji", id: 1}], b.datas = [], b.trueAnswer = 0, b.showNext = 0, b.loadDataDone = !1;
        var k, l = 2, m = 0, n = 0;
        null != k && (l = k), b.selectTabJLPT = function (a) {
            l = a, $(".item-subleft-menu").removeClass("item-subleft-menu-active"), $(".tabjlpt" + a).addClass("item-subleft-menu-active"), h(), j(parseInt(a))
        }, b.chooseAnswer = function (a) {
            $(".card-choice").removeClass("box-choice"), $(".testjlpt" + a).addClass("box-choice"), b.buttonDisabled = !0, n = a
        }, b.check = function () {
            var a = b.datas[m].correct;
            b.testAnswer = b.datas[m].answerNew[a], m != b.datas.length - 1 ? b.showNext = 1 : b.showNext = 2, a == n ? (b.trueAnswer++, $(".progress-bar").animate({width: b.trueAnswer / b.size * 100 + "%"}, 100), $(".box-notify-correct").addClass("box-notify-show")) : $(".box-notify-fails").addClass("box-notify-show")
        }, b.next = function () {
            $(".card-choice").removeClass("box-choice"), $(".jlpt-test-item div:first").next().show(), $(".jlpt-test-item div:first").animate({left: "-150%"}, 200, function () {
                $(this).css("left", "150%"), $(this).appendTo(".jlpt-test-item"), $(this).hide()
            }), $(".jlpt-test-item div:first").next().animate({left: "0"}, 200), d(function () {
                m++, b.showNext = 0, $(".box-notify").removeClass("box-notify-show"), b.buttonDisabled = !1, b.jlptActive = b.datas[m]
            }, 300)
        }, b.finish = function () {
            b.showNext = 3, $(".box-notify").removeClass("box-notify-show"), $(".finish-test-jlpt").fadeIn(3e3), m = 0, b.buttonDisabled = !1
        }, b.refresh = function () {
            h(), j(parseInt(l))
        }, j(l), d(function () {
            $(".tabjlpt" + l).addClass("item-subleft-menu-active"), 0 == $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").addClass("left-menu-cover"), 0 == $(".main-content").hasClass("main-content-cover") && $(".main-content").addClass("main-content-cover")
        }, 100), trackView("jlpttest")
    }]), angular.module("maziiLearn").controller("MinnaController", ["$rootScope", "$scope", "$state", "$timeout", "dataServ", "$window", "localstoreServ", function (a, b, c, d, e, f, g) {
        function h() {
            $("body").scrollTop() > 0 && $("body").animate({scrollTop: 0}, 500)
        }
        function i(a, b) {
            var c = $("#" + b);
            $("#" + b + ">source").attr("src", a), c.preload = "auto", c.load()
        }
        function j() {
            switch (parseInt(b.activeTab)) {
                case 0:
                    e.getKotoba(parseInt(b.activeId), function (a) {
                        b.datas = a, e.getListenLession(parseInt(b.activeId), "Kotoba", function (a) {
                            b.listens = "http://eup.mobi/apps/mina/listen/" + decodeURIComponent(a[0].link), i(b.listens, "music-kotoba")
                        })
                    });
                    break;
                case 1:
                    e.getGrammar(parseInt(b.activeId), function (a) {
                        for (var c = a.length, d = 0; c > d; d++) {
                            var e = a[d].content.split("$");
                            a[d].content = e
                        }
                        b.datas = a
                    });
                    break;
                case 2:
                    e.getKaiwa(parseInt(b.activeId), function (a) {
                        b.datas = a, e.getListenLession(parseInt(b.activeId), "Kaiwa", function (a) {
                            b.listens = "http://eup.mobi/apps/mina/listen/" + decodeURIComponent(a[0].link), i(b.listens, "music-kaiwa")
                        })
                    });
                    break;
                case 3:
                    e.getMondai(parseInt(b.activeId), function (a) {
                        for (var c = a, d = c.length, e = 0; d > e; e++)
                            if ("1" === c[e].type) {
                                for (var f = c[e].answer.split("∴"), g = [], h = 0; h < f.length; h++) {
                                    var i = f[h].split("※");
                                    g.push(i)
                                }
                                c[e].answer = g
                            } else {
                                var f = c[e].answer.split("※");
                                c[e].answer = f
                            }
                        for (var j = new Array, e = 0; d > e; e++)
                            j[e] = e;
                        b.slides = a, b.mondaisLength = j
                    }), e.getListenLession(parseInt(b.activeId), "Mondai", function (a) {
                        for (var c = 0; c < a.length; c++)
                            "Mondai1" == a[c].type ? (b.mondaisListen[1] = "http://eup.mobi/apps/mina/listen/" + decodeURIComponent(a[c].link), i(b.mondaisListen[1], "music-mondai1")) : "Mondai2" == a[c].type ? (b.mondaisListen[2] = "http://eup.mobi/apps/mina/listen/" + decodeURIComponent(a[c].link), i(b.mondaisListen[2], "music-mondai2")) : "Mondai3" == a[c].type && (b.mondaisListen[3] = "http://eup.mobi/apps/mina/listen/" + decodeURIComponent(a[c].link), i(b.mondaisListen[3], "music-mondai3"))
                    });
                    break;
                case 4:
                    e.getBunkei(parseInt(b.activeId), function (a) {
                        b.datas = a
                    }), e.getListenLession(parseInt(b.activeId), "Bunkei", function (a) {
                        b.listens = "http://eup.mobi/apps/mina/listen/" + decodeURIComponent(a[0].link), i(b.listens, "music-bunkei")
                    });
                    break;
                case 5:
                    e.getReibun(parseInt(b.activeId), function (a) {
                        b.datas = a, e.getListenLession(parseInt(b.activeId), "Reibun", function (a) {
                            b.listens = "http://eup.mobi/apps/mina/listen/" + decodeURIComponent(a[0].link), i(b.listens, "music-reibun")
                        })
                    });
                    break;
                case 6:
                    e.getReference(parseInt(b.activeId), function (a) {
                        b.datas = a
                    })
            }
            h()
        }
        b.lessionId = [], b.activeTab = "0", b.activeId = "1", b.titleSub = "Từ mới", b.slides = [], b.stateMondai = 0, b.mondaisListen = [], b.listens = null, b.buttonDisabled = !1, b.lessionName = ["Từ mới", "Ngữ pháp", "Kaiwa", "Mondai", "Bunkei", "Reibun", "Tham khảo"];
        var k = {}, l = 0, m = 0, n = [];
        k = g.getItem("mina"), null == k ? (k = {activeId: b.activeId, activeTab: b.activeTab}, g.setItem("mina", k)) : (b.activeId = k.activeId, b.activeTab = k.activeTab, b.titleSub = b.lessionName[k.activeTab]);
        for (var o = 1; 50 >= o; o++)
            10 > o ? b.lessionId.push("Bài 0" + o) : b.lessionId.push("Bài " + o);
        b.selectTabMina = function (a) {
            b.activeTab = a, k.activeTab = a, g.setItem("mina", k), b.titleSub = b.lessionName[a], $(".item-header").removeClass("item-header-active"), $(".tabmina" + a).addClass("item-header-active"), $(".list-grammar").removeClass("open"), 3 == b.activeTab && $(".itemSlide0").addClass("minano-selected"), j()
        }, b.selectLessonMina = function (a) {
            b.activeId = a, k.activeId = a, g.setItem("mina", k), $(".item-subleft-menu").removeClass("item-subleft-menu-active"), $(".itemLesson" + a).addClass("item-subleft-menu-active"), $(".list-grammar").removeClass("open"), 3 == b.activeTab && $(".itemSlide0").addClass("minano-selected"), j()
        }, b.clickGrammar = function (a) {
            var b = a.currentTarget;
            -1 != b.className.indexOf("open") ? b.className = b.className.replace("open", "") : ($(".list-grammar").removeClass("open"), b.className += " open")
        }, b.getNumber = function (a) {
            for (var b = new Array, c = 0; a > c; c++)
                b[c] = c;
            return b
        }, b.getActiveSilde = function (a) {
            a = parseInt(a), b.slides[a].active = !0, b.activeSlide = a;
            for (var c = $(".music-player>audio"), d = 0; d < c.length; d++)
                c[d].played.length && c[d].pause();
            $(".item-number-slide").removeClass("minano-selected"), $(".itemSlide" + b.activeSlide).addClass("minano-selected"), b.stateMondai = parseInt(a) + 1, n = [], b.buttonDisabled = !1
        }, b.$watch(function () {
            for (var a = 0; a < b.slides.length; a++)
                if (b.slides[a].active)
                    return a
        }, function (a, c) {
            a !== c && "undefined" != typeof a && b.getActiveSilde(a)
        }), b.chooseAnswer1 = function (a, c) {
            b.buttonDisabled = !0, b.stateMondai = 1, l = a, m = c
        }, b.chooseAnswer2 = function (a, c, d, e) {
            var f = e.currentTarget;
            b.buttonDisabled = !0, $("#number" + c + " .button").removeClass("box-choice"), f.classList.add("box-choice"), b.stateMondai = 2, l = a, n[c] = d
        }, b.chooseAnswer3 = function (a, c, d, e) {
            var f = e.currentTarget;
            b.buttonDisabled = !0, $("#check" + c + " div").removeClass("a-choice"), f.classList.add("a-choice"), b.stateMondai = 3, l = a, n[c] = d
        }, b.checkMondai = function () {
            if (b.buttonDisabled = !1, 1 == b.stateMondai)
                $(".mondai1").show();
            else if (2 == b.stateMondai) {
                for (var a = b.slides.length, c = 0; a > c; c++)
                    if (b.slides[c].id == l)
                        for (var d = b.slides[c].answer, e = 0; e < d.length; e++)
                            0 != n[e + 1] && null != n[e + 1] && $("#number" + (e + 1) + " ." + d[e]).hasClass("box-choice") && n[e + 1] == d[e] ? ($("#number" + (e + 1) + " ." + d[e]).removeClass("box-choice"), $("#number" + (e + 1) + " ." + d[e]).addClass("box-check")) : $("#number" + (e + 1) + " ." + d[e]).addClass("box-fail")
            } else if (3 == b.stateMondai)
                for (var a = b.slides.length, c = 0; a > c; c++)
                    if (b.slides[c].id == l)
                        for (var d = b.slides[c].answer, e = 0; e < d.length; e++)
                            0 != n[e + 1] && null != n[e + 1] && $("#check" + (e + 1) + " ." + d[e]).hasClass("a-choice") && n[e + 1] == d[e] ? ($("#check" + (e + 1) + " ." + d[e]).removeClass("a-choice"), $("#check" + (e + 1) + " ." + d[e]).addClass("a-check")) : $("#check" + (e + 1) + " ." + d[e]).addClass("a-fail")
        }, $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").removeClass("left-menu-cover"), $(".main-content").hasClass("main-content-cover") && $(".main-content").removeClass("main-content-cover"), j(), d(function () {
            $(".tabmina" + b.activeTab).addClass("item-header-active"), $(".itemLesson" + b.activeId).addClass("item-subleft-menu-active"), $(".itemSlide0").addClass("minano-selected")
        }, 100), trackView("minanonihongo")
    }]), angular.module("maziiLearn").controller("SearchController", ["$rootScope", "$scope", "$state", "$timeout", "dataServ", "$window", "localstoreServ", function (a, b, c, d, e, f, g) {
        function h() {
            $(".music-icon").removeClass("music-icon-load"), null != l && (l[0].pause(), l[0].currentTime = 0, l = null, $("#music-compharse>source").attr("src", ""))
        }
        function i() {
            $("body").scrollTop() > 0 && $("body").animate({scrollTop: 0}, 500)
        }
        function j(a) {
            switch (b.more = !1, parseInt(b.activeTab)) {
                case 0:
                    e.getSearchKotoba(a, 0, function (a) {
                        for (var c = 0; c < a.data.length; c++)
                            a.data[c].id = parseInt(a.data[c].id);
                        b.datas = a.data, 0 != a.isMore && (b.more = !0, b.isMore = a.isMore)
                    });
                    break;
                case 1:
                    e.getSearchGrammar(a, 0, function (a) {
                        for (var c = a.data.length, d = 0; c > d; d++) {
                            var e = a.data[d].content.split("$");
                            a.data[d].content = e, a.data[d].id = parseInt(a.data[d].id)
                        }
                        b.datas = a.data, 0 != a.isMore && (b.more = !0, b.isMore = a.isMore)
                    });
                    break;
                case 2:
                    e.getSearchKanji(a, 0, function (a) {
                        b.datas = a.data, 0 != a.isMore && (b.more = !0, b.isMore = a.isMore)
                    });
                    break;
                case 3:
                    e.getSearchCompharse(a, 0, function (a) {
                        b.datas = a.data, 0 != a.isMore && (b.more = !0, b.isMore = a.isMore)
                    });
                    break;
                case 4:
                    e.getSearchIKanji(a, 0, function (a) {
                        b.datas = a.data, 0 != a.isMore && (b.more = !0, b.isMore = a.isMore)
                    })
                }
        }
        b.tabs = ["Từ vựng", "Ngữ pháp", "Kanji", "Mẫu câu", "IKanji"], b.activeTab = 0, b.kanjiSample = "", b.detailKanji = null, b.detailAdvanKanji = null;
        var k = null, l = null;
        b.more = !1, b.datas = [];
        var m = g.getItem("search-mina");
        null == m ? (m = b.activeTab, g.setItem("search-mina", m)) : b.activeTab = m, b.changeTabSearch = function (a) {
            i(), $(".list-grammar").removeClass("open"), h(), b.activeTab = a, b.isMore = 0, g.setItem("search-mina", b.activeTab), $(".item-header").removeClass("item-header-active"), $(".tabsearch" + b.activeTab).addClass("item-header-active"), "" != $(".ip-header").val() ? j($(".ip-header").val()) : b.datas = []
        }, b.clickGrammar = function (a) {
            var b = a.currentTarget;
            -1 != b.className.indexOf("open") ? b.className = b.className.replace("open", "") : ($(".list-grammar").removeClass("open"), b.className += " open")
        }, a.inputSearch = function (a, c) {
            return i(), clearTimeout(k), $(".list-grammar").removeClass("open"), "" != a ? 13 == c ? (b.datas = [], void j(a)) : void(k = setTimeout(function () {
                "" != a && j(a)
            }, 300)) : void 0
        }, b.clickPhrase = function (a, b) {
            var c = b.currentTarget;
            if (h(), $(".phrase").removeClass("open"), -1 != c.className.indexOf("open"))
                c.className = c.className.replace("open", "");
            else {
                if ($(".list-phrase").removeClass("open"), c.className += " open", null != l)
                    return;
                $(".music-icon").addClass("music-icon-load");
                var d = "db/phrase/" + a + ".mp3";
                l = $("#music-compharse"), $("#music-compharse>source").attr("src", d), l[0].autoplay = !0, l[0].load(), l[0].onended = function () {
                    h()
                }, l[0].play()
            }
        }, b.playAudio = function (a, b) {
            var c = "db/phrase/" + a + ".mp3";
            b.stopImmediatePropagation();
            var d = b.currentTarget;
            d.className += " music-icon-load", null == l && (l = $("#music-compharse"), $("#music-compharse>source").attr("src", c), l[0].autoplay = !0, l[0].load(), l[0].onended = function () {
                h()
            }, l[0].play())
        }, b.viewContentAdvanKanji = function (a) {
            $(".advankanji-item").removeClass("advankanji-item-active"), $(".advankanji-content-item" + a).addClass("advankanji-item-active");
            for (var c = b.datas.length, e = 0; c > e; e++)
                if (b.datas[e].id == a) {
                    if (b.detailAdvanKanji = b.datas[e], b.advanKanji = b.detailAdvanKanji.word, "" != b.datas[e].note) {
                        for (var f = b.datas[e].note.split("※"), g = [], e = 0; e < f.length; e++) {
                            var h = f[e].split("∴");
                            g.push(h)
                        }
                        b.detailAdvanKanji.noteDetail = g
                    }
                    break
                }
            d(function () {
                $("#myAdvanKanji").modal()
            }, 10)
        }, b.viewDetailIKanji = function (a) {
            var c = b.datas.length;
            b.detailKanji = [];
            for (var e = 0; c > e; e++)
                if (b.datas[e].id == a) {
                    b.detailKanji = b.datas[e], b.kanjiSample = b.detailKanji.word;
                    var f = [];
                    if ("" != b.datas[e].note)
                        for (var g = b.datas[e].note.split("※"), e = 0; e < g.length; e++) {
                            var h = g[e].split("∴");
                            f.push(h)
                        }
                    b.detailKanji.detailKanjiNote = f;
                    break
                }
            d(function () {
                $("#myIKanji").modal()
            }, 10)
        }, b.loadMore = function () {
            var a = $(".ip-header").val().trim();
            switch (parseInt(b.activeTab)) {
                case 0:
                    "" != a && e.getSearchKotoba(a, b.isMore, function (a) {
                        for (var c = a.data.length, d = 0; c > d; d++)
                            b.datas.push(a.data[d]);
                        0 != a.isMore ? b.isMore = a.isMore : b.more = !1
                    });
                    break;
                case 1:
                    "" != a && e.getSearchGrammar(a, b.isMore, function (a) {
                        for (var c = a.data.length, d = 0; c > d; d++) {
                            var e = a.data[d].content.split("$");
                            a.data[d].content = e, b.datas.push(a.data[d])
                        }
                        0 != a.isMore ? b.isMore = a.isMore : b.more = !1
                    });
                    break;
                case 2:
                    "" != a && e.getSearchKanji(a, b.isMore, function (a) {
                        for (var c = a.data.length, d = 0; c > d; d++)
                            b.datas.push(a.data[d]);
                        0 != a.isMore ? b.isMore = a.isMore : b.more = !1
                    });
                    break;
                case 3:
                    "" != a && e.getSearchCompharse(a, b.isMore, function (a) {
                        for (var c = a.data.length, d = 0; c > d; d++)
                            b.datas.push(a.data[d]);
                        0 != a.isMore ? b.isMore = a.isMore : b.more = !1
                    });
                    break;
                case 4:
                    "" != a && e.getSearchIKanji(a, b.isMore, function (a) {
                        for (var c = a.data.length, d = 0; c > d; d++)
                            b.datas.push(a.data[d]);
                        0 != a.isMore ? b.isMore = a.isMore : b.more = !1
                    })
                }
        }, $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").removeClass("left-menu-cover"), $(".main-content").hasClass("main-content-cover") && $(".main-content").removeClass("main-content-cover"), d(function () {
            $(".tabsearch" + b.activeTab).addClass("item-header-active")
        }, 100), trackView("search")
    }]), angular.module("maziiLearn").controller("ReferenceController", ["$rootScope", "$scope", "$state", "$timeout", "dataServ", "$window", "localstoreServ", function (a, b, c, d, e, f, g) {
        function h() {
            $("body").scrollTop() > 0 && $("body").animate({scrollTop: 0}, 500)
        }
        function i() {
            "$apply" != b.$root.$$phase && "$digest" != b.$root.$$phase && b.$apply()
        }
        function j() {
            switch (parseInt(b.activeTab)) {
                case 0:
                    e.getDoushi(l++, function (a) {
                        for (var c = 0; c < a.length; c++)
                            a[c].id = parseInt(a[c].id);
                        b.datas = a, b.more = !1
                    });
                    break;
                case 1:
                    0 == n.length ? e.getJitadoushi(function (a) {
                        b.datas = a, b.more = !1, n = a
                    }) : (b.datas = n, i());
                    break;
                case 2:
                    e.getKanjiset(l++, function (a) {
                        for (var c = 0; c < a.length; c++)
                            a[c].id = parseInt(a[c].id);
                        b.datas = a, b.more = !1
                    })
                }
        }
        b.activeTab = "0", b.tabs = ["Bảng chia động từ", "Bảng tự/tha động từ", "214 Nét kanji cơ bản"];
        var k = null, l = 1, m = null;
        b.more = !0, b.datas = [];
        var n = [];
        k = g.getItem("reference"), null == k ? (k = b.activeTab, g.setItem("reference", k)) : b.activeTab = k, b.changeTabReference = function (a) {
            h(), b.activeTab = a, k = a, l = 1, b.more = !0, $(".input-reference").val(""), g.setItem("reference", k), $(".item-header").removeClass("item-header-active"), $(".tabReference" + a).addClass("item-header-active"), j()
        }, b.enterInput = function (a, c) {
            if (clearTimeout(m), b.more = !0, $(".list-duoshi").removeClass("open"), 13 == c)
                if ("0" == b.activeTab)
                    "" != a ? e.getDoushiQuery(a, 0, function (a) {
                        if (null != a.data)
                            for (var c = 0; c < a.data.length; c++)
                                a.data[c].id = parseInt(a.data[c].id);
                        else
                            a.data = [];
                        b.datas = a.data, 0 != a.isMore && (b.more = !1, b.isMore = a.isMore)
                    }) : (l = 1, j());
                else if ("1" == b.activeTab)
                    if ("" != a) {
                        for (var d = [], f = 0; f < n.length; f += 2)
                            (-1 != n[f].jidoushi.indexOf(a) || -1 != n[f].roumaji.indexOf(a) || -1 != n[f].ji_mean.indexOf(a) || -1 != n[f].ji_umean.indexOf(a) || -1 != n[f].tadoushi.indexOf(a) || -1 != n[f + 1].jidoushi.indexOf(a) || -1 != n[f + 1].roumaji.indexOf(a) || -1 != n[f + 1].ji_mean.indexOf(a) || -1 != n[f + 1].ji_umean.indexOf(a) || -1 != n[f + 1].tadoushi.indexOf(a)) && (d.push(n[f]), d.push(n[f + 1]));
                        b.datas = d, i()
                    } else
                        l = 1, j();
                else
                    "2" == b.activeTab && ("" != a ? e.getKanjisetQuery(a, 0, function (a) {
                        if (null != a.data)
                            for (var c = 0; c < a.data.length; c++)
                                a.data[c].id = parseInt(a.data[c].id);
                        else
                            a.data = [];
                        b.datas = a.data, 0 != a.isMore && (b.more = !1, b.isMore = a.isMore)
                    }) : (l = 1, j()));
            m = setTimeout(function () {
                if ($(".list-duoshi").removeClass("open"), "0" == b.activeTab)
                    "" != a ? e.getDoushiQuery(a, 0, function (a) {
                        if (null != a.data)
                            for (var c = 0; c < a.data.length; c++)
                                a.data[c].id = parseInt(a.data[c].id);
                        else
                            a.data = [];
                        b.datas = a.data, 0 != a.isMore && (b.more = !1, b.isMore = a.isMore)
                    }) : (l = 1, j());
                else if ("1" == b.activeTab)
                    if ("" != a) {
                        for (var c = [], d = 0; d < n.length; d += 2)
                            (-1 != n[d].jidoushi.indexOf(a) || -1 != n[d].roumaji.indexOf(a) || -1 != n[d].ji_mean.indexOf(a) || -1 != n[d].ji_umean.indexOf(a) || -1 != n[d].tadoushi.indexOf(a) || -1 != n[d + 1].jidoushi.indexOf(a) || -1 != n[d + 1].roumaji.indexOf(a) || -1 != n[d + 1].ji_mean.indexOf(a) || -1 != n[d + 1].ji_umean.indexOf(a) || -1 != n[d + 1].tadoushi.indexOf(a)) && (c.push(n[d]), c.push(n[d + 1]));
                        b.datas = c, i()
                    } else
                        l = 1, j();
                else
                    "2" == b.activeTab && ("" != a ? e.getKanjisetQuery(a, 0, function (a) {
                        if (null != a.data)
                            for (var c = 0; c < a.data.length; c++)
                                a.data[c].id = parseInt(a.data[c].id);
                        else
                            a.data = [];
                        b.datas = a.data, 0 != a.isMore && (b.more = !1, b.isMore = a.isMore)
                    }) : (l = 1, j()))
            }, 200)
        }, b.clickDuoshi = function (a) {
            var b = a.currentTarget;
            -1 != b.className.indexOf("open") ? b.className = b.className.replace("open", "") : ($(".list-duoshi").removeClass("open"), b.className += " open")
        }, b.loadMore = function () {
            var a = $(".input-reference").val().trim();
            "0" == b.activeTab && 0 == b.more ? "" == a ? e.getDoushi(l++, function (a) {
                var c = a.length;
                10 > c && (b.more = !1);
                for (var d = 0; c > d; d++)
                    a[d].id = parseInt(a[d].id), b.datas.push(a[d])
            }) : e.getDoushiQuery(a, b.isMore, function (a) {
                var c = a.data.length;
                0 != a.isMore ? b.isMore = a.isMore : b.more = !1;
                for (var d = 0; c > d; d++)
                    b.datas.push(a.data[d])
            }) : "2" == b.activeTab && 0 == b.more && e.getKanjiset(l++, function (a) {
                var c = a.length;
                10 > c && (b.more = !1);
                for (var d = 0; c > d; d++)
                    a[d].id = parseInt(a[d].id), b.datas.push(a[d])
            })
        }, j(), d(function () {
            $(".tabReference" + b.activeTab).addClass("item-header-active")
        }, 100), $(".left-menu").hasClass("left-menu-cover") && $(".left-menu").removeClass("left-menu-cover"), $(".main-content").hasClass("main-content-cover") && $(".main-content").removeClass("main-content-cover"), trackView("reference")
    }]);